# 認証機能テスト手順

## 概要
issue-24-event-listブランチで実装された認証機能のテスト手順です。

## テスト環境
- Dockerコンテナを使用
- ポート: http://localhost:3000
- データベース: PostgreSQL

## テスト手順

### 1. アプリケーション起動確認
```bash
# Dockerコンテナの起動
docker compose up -d

# アプリケーションの状態確認
docker compose logs app-dev --tail=10

# ホームページアクセス確認
curl -s http://localhost:3000 | head -5
```

### 2. 未認証状態でのテスト

#### 2.1 ヘッダーの表示確認
- ブラウザで http://localhost:3000 にアクセス
- ヘッダーに「一覧」リンクが表示されることを確認
- 未認証状態では「ログイン」リンクが表示されることを確認

#### 2.2 一覧ページへのアクセス
- ヘッダーの「一覧」をクリック
- 認証状態の確認中メッセージが表示されることを確認
- 未認証のため、Google認証ページが表示されることを確認

#### 2.3 認証ページの表示確認
- 美しいデザインのログイン画面が表示されることを確認
- Googleログインボタンが表示されることを確認
- 機能説明が表示されることを確認

### 3. 認証状態でのテスト

#### 3.1 Google認証の実行
- Googleログインボタンをクリック
- Google認証画面が表示されることを確認
- 認証が成功するとイベント一覧ページにリダイレクトされることを確認

#### 3.2 認証後のヘッダー表示
- ヘッダーにユーザー名が表示されることを確認
- 「設定」リンクが表示されることを確認
- ユーザーメニューが表示されることを確認

#### 3.3 イベント一覧の表示
- 認証済みユーザーの飲み会一覧が表示されることを確認
- ローディング状態が適切に表示されることを確認
- エラーハンドリングが適切に動作することを確認

### 4. ログアウト機能のテスト

#### 4.1 ログアウトの実行
- ヘッダーのユーザーメニューをクリック
- 「ログアウト」をクリック
- ホームページにリダイレクトされることを確認

#### 4.2 ログアウト後の状態確認
- ヘッダーに「ログイン」リンクが表示されることを確認
- 一覧ページにアクセスすると再び認証が必要になることを確認

## 実装された機能

### 1. ヘッダーコンポーネント (`src/components/Header.tsx`)
- 認証状態に応じたナビゲーション表示
- ユーザー情報の表示
- ログアウト機能
- ドロップダウンメニュー

### 2. イベント一覧ページ (`src/app/events/page.tsx`)
- 認証状態のチェック
- 未認証時のGoogle認証ページ表示
- 認証済み時の飲み会一覧表示
- ローディング状態の改善
- エラーハンドリング

### 3. サインインページ (`src/app/auth/signin/page.tsx`)
- 美しいデザインのログイン画面
- Google認証ボタン
- 機能説明の表示
- レスポンシブデザイン

### 4. NextAuth設定 (`src/app/api/auth/[...nextauth]/route.ts`)
- Google認証プロバイダーの設定
- セッション管理
- コールバックURLの処理

## 技術仕様

### 認証フロー
1. ユーザーが「一覧」をクリック
2. 認証状態をチェック
3. 未認証の場合：Google認証ページを表示
4. 認証済みの場合：飲み会一覧を表示

### 使用技術
- Next.js 14 (App Router)
- NextAuth.js v4
- TypeScript
- Tailwind CSS
- Prisma (PostgreSQL)
- Docker

### セキュリティ
- JWTセッション管理
- 環境変数による設定管理
- 認証状態の適切なチェック

## 注意事項
- Google認証を使用するため、適切な環境変数（GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET）の設定が必要
- 本番環境ではHTTPSの設定が必要
- データベースのマイグレーションが完了していることを確認 
